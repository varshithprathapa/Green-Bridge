<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Organizer Dashboard</title>
<style>
  body { font-family: Arial; background:#f1f8f6; padding:20px; }
  h1 { color:#1b4332; text-align:center; margin-bottom:20px; }
  table { width:100%; border-collapse:collapse; margin-top:20px; }
  th, td { border:1px solid #ccc; padding:10px; text-align:left; }
  th { background:#2d6a4f; color:white; }
  .btn { display:inline-block; margin:10px 0; padding:10px 15px; background:#2d6a4f; color:white; text-decoration:none; border-radius:5px; }
  .btn:hover { background:#1b4332; }
</style>
</head>
<body>
  <h1>Organizer Dashboard</h1>

  <!-- Button to go to event creation page -->
  <a href="event-conduct.html" class="btn">+ Conduct New Event</a>

  <!-- NEW Button: View Volunteers who joined -->
  <a href="assigned-volunteers.html" class="btn">ðŸ‘¥ View Joined Volunteers</a>

  <h2>Reported Problems</h2>
  <table id="problemsTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Description</th>
        <th>Location</th>
        <th>Reported By</th>
        <th>Status</th>
        <th>Created At</th>
      </tr>
    </thead>
    <tbody>
      <!-- Problems from DB will appear here -->
    </tbody>
  </table>

  <script>
    async function loadProblems() {
      try {
        const res = await fetch("http://localhost:5000/api/problems");
        const problems = await res.json();
        const tbody = document.querySelector("#problemsTable tbody");
        tbody.innerHTML = "";

        problems.forEach(problem => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${problem.id}</td>
            <td>${problem.title}</td>
            <td>${problem.description}</td>
            <td>${problem.location || ''}</td>
            <td>${problem.reported_by || ''}</td>
            <td>${problem.status}</td>
            <td>${new Date(problem.created_at).toLocaleString()}</td>
          `;
          tbody.appendChild(tr);
        });
      } catch (err) {
        console.error("Error fetching problems:", err);
      }
    }

    // Load problems on page load
    loadProblems();
  </script>
</body>
</html>
